@{
    ViewData["Title"] = "Hotel";
}

@*  html *@
 
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark gradient-custom">
    <!-- Container wrapper -->
    <div class="container-fluid">
        <!-- Navbar brand -->
        <a class="navbar-brand" href="#">FunNow</a>

        <!-- Toggle button -->
        <button class="navbar-toggler" type="button" data-mdb-toggle="collapse"
                data-mdb-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <i class="fas fa-bars text-light"></i>
        </button>

        <!-- Collapsible wrapper -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- Left links -->
            <ul class="navbar-nav me-auto d-flex flex-row mt-3 mt-lg-0">
                <li class="nav-item text-center mx-2 mx-lg-1">
                    <a class="nav-link" href="#!">
                        <div>
                            <i class="fa-solid fa-user mb-1"></i>
                            <span class="badge rounded-pill badge-notification bg-dark"></span>
                        </div>
                        會員
                    </a>
                </li>
                <li class="nav-item text-center mx-2 mx-lg-1">
                    <a class="nav-link" href="#!">
                        <div>
                            <i class="fa-solid fa-house mb-1"></i>
                            <span class="badge rounded-pill badge-notification bg-dark">2</span>
                        </div>
                        房東
                    </a>
                </li>
                <li class="nav-item text-center mx-2 mx-lg-1">
                    <a class="nav-link" href="#!">
                        <div>
                            <i class="fa-solid fa-face-smile mb-1"></i>
                            <span class="badge rounded-pill badge-notification bg-dark">11</span>
                        </div>
                        評論
                    </a>
                </li>
                <li class="nav-item text-center mx-2 mx-lg-1">
                    <a class="nav-link" href="#!">
                        <div>
                            <i class="fa-solid fa-comment mb-1"></i>
                            <span class="badge rounded-pill badge-notification bg-dark">1</span>
                        </div>
                        訊息
                    </a>
                </li>
                <li class="nav-item text-center mx-2 mx-lg-1">
                    <a class="nav-link" href="#!">
                        <div>
                            <i class="fa-solid fa-chart-line mb-1"></i>
                            <span class="badge rounded-pill badge-notification bg-dark"></span>
                        </div>
                        數據分析
                    </a>
                </li>
            </ul>
            <!-- Left links -->
        </div>
        <!-- Collapsible wrapper -->
    </div>
    <!-- Container wrapper -->
</nav>
<!-- Navbar -->
<div class="container">
    <h3 class="m-3">飯店審核管理</h3>
</div>

<div class="container mt-3 d-flex flex-row ">
    <div class="input-group width px-3">
        <select class="form-select" id="inputGroupSelecthotel" aria-label="Example select with button addon">
            <option selected>飯店名稱</option>
            <!-- 动态添加的酒店名称将在这里显示 -->
            <option value="${item.hotelId}">${item.hotelName}</option>
        </select>
    </div>

    <div class="input-group width px-1">
        <!--px-1(數字好像可以填1到9越小越寬) -->
        <select class="form-select" id="inputGroupSelectstatus" aria-label="Example select with button addon">
        <option value="all" selected>飯店審核狀態</option>
        <option value="pending">待審核</option>
        <option value="active">已上架</option>
    </select>
    </div>

    <div class="ms-5">
        <span>
            <input type="text" class="form-control display" id="searchBar" aria-label="" placeholder="輸入文字">
        </span>
    </div>
    <div>
        <input type="button" class="btn btn-outline-primary display" id="searchBtn" value="搜尋" onclick="searchHotels()">
    </div>
</div>



<div>
    <table class="container table table-hover">
        <thead>
            <tr>
                <td>編號</td>
                <td>飯店名稱</td>
                <td>地址</td>
                <td>電話</td>
                <td>飯店狀態</td>

            </tr>
        </thead>
        <tbody id="hotelContainer">
            <tr>
                <td>1</td>
                <td>三景花園飯店</td>
                <td>雙人房</td>
                <td>忠孝東路三段30號1樓 </td>
                <td>(02)2781-1131</td>
                <td>
                    <select>
                        <option>待審核</option>
                        <option>已上架</option>
                       
                    </select>
                </td>
                <td><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">詳細內容</button></td>
            </tr>
        </tbody>

    </table>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <style>
            /* 修改 modal-dialog 的 max-width 以增加寬度 */
            #exampleModal .modal-dialog {
                max-width: 80%; /* 例如將寬度設置為 80%，可以根據需要調整 */
            }
        </style>
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">房間內容</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div>
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <td colspan="3">@* <img src="~/image/ez/room1.jpg" width="300" height="200"> *@</td>
                                    <td style="width: 8%;">飯店編號</td>
                                    <td style="width: 14%;">飯店名稱</td>
                                    <td style="width: 8%;">房間編號</td>
                                    <td style="width: 10%;">房型</td>
                                    <td style="width: 10%;">房間價格</td>
                                    <td style="width: 10%;">房間大小</td>
                                    <td style="width: 40%;">房間描述</td>
                                    <td></td>
                                </tr>
                            </thead>
                            <tr>
                                <td><img src="~/image/ez/room2.jpg" width="150" height="150"></td>
                                <td><img src="~/image/ez/room3.jpg" width="150" height="150"></td>
                                <td><img src="~/image/ez/room4.jpg" width="150" height="150"></td>
                                <td>1</td>
                                <td>三景花園飯店</td>
                                <td>1</td>
                                <td>雙人房</td>
                                <td>3000</td>
                                <td>21 平方公尺</td>
                                <td>這間雙人房提供空調、茶／咖啡沖泡設備和露臺，可欣賞市景，私人衛浴內附淋浴間。此住宿空間配有 1 張床。</td>
                                <td></td>
                            </tr>

                        </table>
                    </div>
                </div>



                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">返回</button>
                    <button type="button" class="btn btn-primary">加入購物車</button>
                </div>
            </div>
        </div>
    </div>

</div>



@section Styles {
    <style>
        /*navbar*/
        .btn {
            padding: .45rem 1.5rem .35rem;
        }

        .gradient-custom {
            /* fallback for old browsers*/
            background: #004B97;
        }
        /*navbar*/

        .container {
            width: 70%;
        }

        .filterborder {
            border: 1px solid #0072E3;
            border-radius: 20px;
            margin-right: 20px;
        }

        .width {
            width: 15%;
        }

    </style>
}

@section Scripts {
    <script>


        let allHotels = [];

        function updateHotelDisplay(hotelList) {
            let tableStr = "";
            let selectStr = "<option selected>選擇飯店</option>";

            hotelList.forEach(item => {
                let status = item.hotelIsActive ? "已上架" : "待審核";
                tableStr += `
                    <tr>
                        <td>${item.hotelID}</td>
                        <td>${item.hotelName}</td>
                        <td>${item.hotelAddress}</td>
                        <td>${item.hotelPhone}</td>
                        <td>${status}</td>
                        <td><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">詳細內容</button></td>
                    </tr>
                `;
                selectStr += `<option value="${item.hotelId}">${item.hotelName}</option>`;
            });

            hotelContainer.innerHTML = tableStr;
            document.getElementById('inputGroupSelecthotel').innerHTML = selectStr;
        }

        function fetchHotels() {
            fetch('https://localhost:7103/api/BackSideHotel')
                .then(response => response.json())
                .then(data => {
                    allHotels = data;
                    updateHotelDisplay(data);
                })
                .catch(error => {
                    console.error('Error fetching hotels:', error);
                });
        }

        document.addEventListener('DOMContentLoaded', fetchHotels);

        document.getElementById('inputGroupSelecthotel').addEventListener('change', function () {
            console.log("Selected hotel ID:", this.value);  // 查看選擇的飯店ID
            const filteredHotels = allHotels.filter(hotel => hotel.hotelId === this.value);
            console.log("Filtered hotels:", filteredHotels);  // 查看過濾後的飯店列表
            updateHotelDisplay(filteredHotels);
        });


   
    </script>
}
}